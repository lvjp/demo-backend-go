---

name: demo-backend-go

services:
  backend:
    build:
      context: ../..
      dockerfile: ./build/Dockerfile
    restart: always
    ports:
      - 8081:8080
    healthcheck:
      test: ["CMD", "/app", "healthcheck"]
  swagger:
    image: swaggerapi/swagger-ui:v5.20.5@sha256:952f5f0d713a87e4d29be045d430885b3eeb3b6e6ea8c941a94098e67eec7f2a
    restart: always
    environment:
      - SWAGGER_JSON=/opt/swagger.yaml
      - VALIDATOR_URL=none
    volumes:
      - ../../api/openapi.yaml:/opt/swagger.yaml
    ports:
      - 8082:8080
    healthcheck:
      test: ["CMD", "curl", "--head", "--fail", "--user-agent", "local-healthcheck", "http://localhost:8080"]
